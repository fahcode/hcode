$(function(){im.init()});var im={winHei:parseInt($("#winHei").height()),state:!0,init:function(){var t=this;t.setWinHei();var n=["bg.jpg","music.png","off.png","on.png","GIC.png","loading/moon.png","loading/moon_bg.png","loading/ld0.png","loading/ld20.png","loading/ld40.png","loading/ld60.png","loading/ld80.png","loading/ld100.png","loading/Christmas.png","loading/deer.png"],a=["loading/year2015.png","loading/tipsList/Bell1.png","loading/tipsList/Bell2.png","loading/tipsList/Bell3.png","loading/tipsList/candy.png","loading/tipsList/club.png","loading/tipsList/leaf.png","loading/tipsList/snowflake_g.png","loading/tipsList/snowflake_r.png","loading/tipsList/snowman.png","loading/tipsList/sock.png","loading/tipsList/star_b.png","loading/tipsList/star_g.png","loading/tipsList/star_r.png","loading/tipsList/star_g_bg.png","loading/tipsList/star_r_bg.png","logo.png","share.png","bg_tips1.png","bg_tips2.png","close.png","hr.png","againBtn.png","shareBtn.png","shootBtn.png","inputBg.png","photoFrame.png"];t.loadingImg("img/",[n,a]),t.doMusics().doAll(),t.doPlay()},setWinHei:function(){var t=this;$(".setWinHei").css("height",t.winHei+"px")},doMusics:function(){var t=this,n=null,a=document.getElementById("closeMusic"),o=document.getElementById("audioBg"),s=document.getElementById("audioBtn"),i=document.getElementById("audioPop"),l=document.getElementById("audioPhoto"),d={doAll:function(){var n=this;$(a).on("touchstart",function(){var a=$(this);a.addClass("doAnimate"),n.doBtn();var s=$(this).attr("datas");1==s?(t.state=!1,a.attr("datas",0),$(".switch").addClass("off"),$(o).attr("src","")):(t.state=!0,a.attr("datas",1),$(".switch").removeClass("off"),$(o).attr("src","music/bg.mp3")),setTimeout(function(){a.removeClass("doAnimate")},500)})},doBg:function(){n=setTimeout(function(){clearTimeout(n);try{o=document.getElementById("audioBg"),o.play()}catch(t){}},2e3)},doBtn:function(){t.state&&(s.play(),this.doBg())},doPop:function(){t.state&&(i.play(),this.doBg())},doPhoto:function(){t.state&&(l.play(),this.doBg())}};return d},loadingImg:function(t,n){function a(n){i=0,s=!1;for(var a=n.length,o=new Image,l=0;a>l;l++)o=new Image,o.src=t+n[l],o.onload=function(){i++,i>=a&&(s=!0)}}function o(){function t(t){if(t>=100){n.attr("class","plan pc100"),$("#load .tipsList").addClass("loadShow");var a=setInterval(function(){s&&(clearInterval(a),$(".play").fadeIn(400,function(){$(this).addClass("animateOk"),setTimeout(function(){$(".logo").addClass("bounce")},3e3),$(".loadingBox").empty()}))},1e3)}else t>=80?(n.attr("class","plan pc80"),$("#load .BellList").addClass("loadShow")):t>=60?(n.attr("class","plan pc60"),$("#load .year2015").addClass("loadShow"),o=1e3):t>=40?(n.attr("class","plan pc40"),$("#load .Christmas").addClass("loadShow")):t>=20?(n.addClass("pc20"),$("#load .deer").addClass("loadShow")):($("#load .moon").addClass("loadShow"),n.attr("class","plan"))}var n=$("#plan"),a=0,o=2e3;t(a);var i=setInterval(function(){a+=20,t(a),a>=100&&clearInterval(i)},o)}var s=(n[0].length,n[1].length,!1),i=0;!function(){a(n[0]);var t=setInterval(function(){s&&(clearInterval(t),a(n[1]),o())},60)}()},flipOut:function(t,n){var a=this;a.doMusics().doBtn();var o=t,s=n>=3?0:n,i=o.children(".item");i.addClass("out").removeClass("in"),setTimeout(function(){i.eq(s).addClass("in").removeClass("out")},225)},doPlay:function(){var t=this,n=$("#isTouch"),a=$("#shareBtn"),o=$("#overBtnBox .againBtn"),s=$("#overBtnBox .saveBtn");n.on("touchstart",function(){var n=$(this),o=n.find(".in").attr("datas");1==o?(t.flipOut(n,o),$(".state2").addClass("show"),t.doMusics().doPop()):2==o&&(a.attr("datas",0),queryEmpno()),$("#inputClose").on("touchstart",function(){$(".state2").removeClass("show").children(".inputBg").addClass("closeAnimate"),t.flipOut(n,0),a.attr("datas",2)})}),o.on("touchstart",function(){console.log(1),selectPhoto("update")}),s.on("touchstart",function(){t.shareFN()})},shareFN:function(){var t='<div id="shareTipsBox"><div class="tipsImg"></div><div class="clBox"></div></div>';$("body").append(t),$("#shareTipsBox").on("touchstart",function(){$(this).remove()})}};